
{{ define "main" }}
<section class="card">
  <h1>My Workouts</h1>
  <div id="workoutTable"></div>
</section>
<script defer src="/js/api.js"></script>
<script>
  window.addEventListener('DOMContentLoaded', async () => {
    await requireAuth('/');
    const rows = await api.listWorkouts(0, 25);
    const html = ['<table class="table"><thead><tr><th>Date</th><th>Session</th><th>Meters</th><th>Main set</th><th>RPE</th></tr></thead><tbody>'];
    (rows||[]).forEach(r => html.push(`<tr><td>${r.date}</td><td>${r.session_name||''}</td><td>${r.total_meters||''}</td><td>${(r.main_set||'').slice(0,80)}</td><td>${r.rpe||''}</td></tr>`));
    html.push('</tbody></table>');
    document.getElementById('workoutTable').innerHTML = html.join('');
  });
</script>
{{ end }}
